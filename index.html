<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>TanhanJay&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="TanhanJay's Blog">
<meta property="og:url" content="tanhanjay.top/index.html">
<meta property="og:site_name" content="TanhanJay's Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TanhanJay's Blog">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="TanhanJay&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">TanhanJay&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">code and life</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="tanhanjay.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-LearnCode笔记-ES6新特性" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/30/LearnCode笔记-ES6新特性/" class="article-date">
  <time datetime="2016-03-30T13:56:59.000Z" itemprop="datePublished">2016-03-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/30/LearnCode笔记-ES6新特性/">LearnCode笔记--ES6新特性</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="E6的写法"><a href="#E6的写法" class="headerlink" title="E6的写法"></a>E6的写法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"tanhanjay"</span>;</span><br><span class="line"><span class="keyword">var</span> myob =&#123;</span><br><span class="line">    age,</span><br><span class="line">    name</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(myob.age);<span class="comment">//result: 30</span></span><br></pre></td></tr></table></figure>
<h3 id="let-定义一个新变量"><a href="#let-定义一个新变量" class="headerlink" title="let 定义一个新变量"></a>let 定义一个新变量</h3><p>​    在es5.1中，block不会形成单独的作用域scope，而在es6中加入了let 声明一个变量 若其在block内声明，在block之外let声明的变量不会被获取到。</p>
<p>Example：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//use let</span></span><br><span class="line"><span class="comment">//if(true)&#123;&#125; 是一个block</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> a =<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">//a is undefine</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//use var</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a =<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">//a = 10</span></span><br></pre></td></tr></table></figure>
<h3 id="class-关键字定义对象"><a href="#class-关键字定义对象" class="headerlink" title="class 关键字定义对象"></a>class 关键字定义对象</h3><p>es6中我们可以使用class来定义类与java中定义类非常相似，看下面的用法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">  <span class="comment">//初始化函数</span></span><br><span class="line">  <span class="keyword">constructor</span>()&#123;  				</span><br><span class="line">  	<span class="keyword">this</span>.name = <span class="string">"tanhanjay"</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">static</span> foo()&#123;				<span class="comment">//static关键字</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Hello ,my name is: "</span>+<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line">  bar()&#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//并且支持继承</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">  barz()&#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Child();</span><br><span class="line">Child.foo();<span class="comment">//结果是： Hello ,my name is :Child</span></span><br></pre></td></tr></table></figure>
<p>可以看出es6中不仅支持非常类似java的类的定义，而且 extends static 关键字的用法也基本相同。</p>
<p>上例中有一个有趣的地方,用于foo方法使用static关键字修饰，所以为静态方法，直接使用类名调用，这时并未经过constructor函数进行初始化，而Child.foo();执行的结果是： Hello ,my name is :Child。后来测试，foo方法的this.name改为this.names 结果依旧是一样的，实际上它都等于this并不会报错。</p>
<h3 id="Arrow-Function"><a href="#Arrow-Function" class="headerlink" title="Arrow Function"></a>Arrow Function</h3><p>javascript大量使用匿名函数来作为方法的参数 称为 callback。now arrow function can be simpler for it .</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].map(<span class="function"><span class="keyword">function</span>(<span class="params">val</span>)</span>&#123;++val&#125;);</span><br><span class="line"><span class="comment">//es6中可以写成</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].map(val =&gt; ++val);</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var module = &#123;</span><br><span class="line">    age: 30,</span><br><span class="line">    foo: function()&#123;</span><br><span class="line">        setTimeout(function()&#123;</span><br><span class="line">            console.log(this.age);</span><br><span class="line">        &#125;.bind(this),100);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>bind去掉之后，result为undefined</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/30/LearnCode笔记-ES6新特性/" data-id="cimf02ydd0004lvz31qf8aget" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Jade教程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/28/Jade教程/" class="article-date">
  <time datetime="2016-03-28T13:51:56.000Z" itemprop="datePublished">2016-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/28/Jade教程/">Jade教程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Jade-模板引擎"><a href="#Jade-模板引擎" class="headerlink" title="Jade - 模板引擎"></a>Jade - 模板引擎</h1><p>Jade 是一个高性能的模板引擎，它深受 <a href="http://haml-lang.com" target="_blank" rel="external">Haml</a> 影响，它是用 JavaScript 实现的, 并且可以供 <a href="http://nodejs.org" target="_blank" rel="external">Node</a> 使用.</p>
<p>翻译: <a href="http://jser.me" target="_blank" rel="external">草依山</a> 等</p>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>从 Jade <code>v0.31.0</code> 开始放弃了对于 <code>&lt;script&gt;</code> 和 <code>&lt;style&gt;</code> 标签的平文本支持. 这个问题你可以在 <code>&lt;script&gt; &lt;style&gt;</code> 标签后加上 <code>.</code> 来解决.</p>
<p>希望这一点能让 Jade 对新手更友好, 同时也不影响到 Jade 本身的能力或者导致过度冗长.</p>
<p>如果你有大量的文件需要转换你可以用下 <a href="https://github.com/ForbesLindesay/fix-jade" target="_blank" rel="external">fix-jade</a> 尝试自动完成这个过程.</p>
<h2 id="Test-drive"><a href="#Test-drive" class="headerlink" title="Test drive"></a>Test drive</h2><p>你可以在网上<a href="http://naltatis.github.com/jade-syntax-docs" target="_blank" rel="external">试玩 Jade</a>.</p>
<h2 id="README-目录"><a href="#README-目录" class="headerlink" title="README 目录"></a>README 目录</h2><ul>
<li><a href="#a1">特性</a></li>
<li><a href="#a2">其它实现</a></li>
<li><a href="#a3">安装</a></li>
<li><a href="#a4">浏览器支持</a></li>
<li><a href="#a5">公开 API</a></li>
<li><a href="#a6">语法</a><ul>
<li><a href="#a6-1">行结束标志</a></li>
<li><a href="#a6-2">标签</a></li>
<li><a href="#a6-3">标签文本</a></li>
<li><a href="#a6-4">注释</a></li>
<li><a href="#a6-5">块注释</a></li>
<li><a href="#a6-6">内联</a></li>
<li><a href="#a6-7">块展开</a></li>
<li><a href="#a6-8">Case</a></li>
<li><a href="#a6-9">属性</a></li>
<li><a href="#a6-10">HTML</a></li>
<li><a href="#a6-11">Doctypes</a></li>
</ul>
</li>
<li><a href="#a7">过滤器</a></li>
<li><a href="#a8">代码</a></li>
<li><a href="#a9">循环</a></li>
<li><a href="#a10">条件语句</a></li>
<li><a href="#a11">模板继承</a></li>
<li><a href="#a12">Block append/prepend</a></li>
<li><a href="#a13">包含</a></li>
<li><a href="#a14">Mixins</a></li>
<li><a href="#a15">产生输出</a></li>
<li><a href="#a16">Makefile 的一个例子</a></li>
<li><a href="#a17">命令行的 Jade</a></li>
<li><a href="#a18">教程</a></li>
<li><a href="#a19">License</a></li>
</ul>
<p><a name="a1"></a></p>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul>
<li>客户端支持</li>
<li>代码高可读</li>
<li>灵活的缩进</li>
<li>块展开</li>
<li>Mixins</li>
<li>静态包含</li>
<li>属性改写</li>
<li>安全，默认代码是转义的</li>
<li>运行时和编译时上下文错误报告 </li>
<li>命令行下编译jade模板</li>
<li>HTML5 模式 (使用 <del><code>!!! 5</code></del> <code>doctype html</code> 文档类型)</li>
<li>在内存中缓存(可选)</li>
<li>合并动态和静态标签类</li>
<li>可以通过 <code>filters</code> 修改树</li>
<li>模板继承</li>
<li>原生支持 <a href="http://expressjs.com" target="_blank" rel="external">Express JS</a> </li>
<li>通过 <code>each</code> 枚举对象、数组甚至是不能枚举的对象</li>
<li>块注释</li>
<li>没有前缀的标签</li>
<li>AST Filters</li>
<li>过滤器<ul>
<li><code>:stylus</code> 必须已经安装 <a href="http://github.com/LearnBoost/stylus" target="_blank" rel="external">stylus</a></li>
<li><code>:less</code> 必须已经安装 <a href="http://github.com/cloudhead/less.js" target="_blank" rel="external">less.js</a> </li>
<li><code>:markdown</code> 必须已经安装 <a href="http://github.com/evilstreak/markdown-js" target="_blank" rel="external">markdown-js</a> 或者 <a href="http://github.com/visionmedia/node-discount" target="_blank" rel="external">node-discount</a> </li>
<li><code>:cdata</code></li>
<li><code>:coffeescript</code> 必须已经安装<a href="http://jashkenas.github.com/coffee-script/" target="_blank" rel="external">coffee-script</a></li>
</ul>
</li>
<li><a href="https://github.com/brianc/jade-mode" target="_blank" rel="external">Emacs Mode</a></li>
<li><a href="https://github.com/digitaltoad/vim-jade" target="_blank" rel="external">Vim Syntax</a></li>
<li><a href="http://github.com/miksago/jade-tmbundle" target="_blank" rel="external">TextMate Bundle</a></li>
<li><a href="https://github.com/aaronmccall/jade.mode" target="_blank" rel="external">Coda/SubEtha syntax Mode</a></li>
<li><a href="http://tjholowaychuk.com/post/1004255394/jade-screencast-template-engine-for-nodejs" target="_blank" rel="external">Screencasts</a></li>
<li><a href="https://github.com/donpark/html2jade" target="_blank" rel="external">html2jade</a> converter</li>
</ul>
<p><a name="a2"></a></p>
<h2 id="其它实现"><a href="#其它实现" class="headerlink" title="其它实现"></a>其它实现</h2><ul>
<li><a href="http://github.com/everzet/jade.php" target="_blank" rel="external">php</a></li>
<li><a href="http://scalate.fusesource.org/versions/snapshot/documentation/scaml-reference.html" target="_blank" rel="external">scala</a></li>
<li><a href="https://github.com/slim-template/slim" target="_blank" rel="external">ruby</a></li>
<li><a href="https://github.com/SyrusAkbary/pyjade" target="_blank" rel="external">python</a></li>
<li><a href="https://github.com/neuland/jade4j" target="_blank" rel="external">java</a></li>
</ul>
<p><a name="a3"></a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>通过 NPM:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jade</span><br></pre></td></tr></table></figure>
<p><a name="a4"></a></p>
<h2 id="浏览器支持"><a href="#浏览器支持" class="headerlink" title="浏览器支持"></a>浏览器支持</h2><p>把 Jade 编译为一个可供浏览器使用的单文件，只需要简单的执行:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ make jade.js</span><br></pre></td></tr></table></figure>
<p>如果你已经安装了 uglifyjs (<code>npm install uglify-js</code>)，你可以执行下面的命令它会生成所有的文件。其实每一个正式版本里都帮你做了这事。 </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make jade.min.js</span><br></pre></td></tr></table></figure>
<p>默认情况下，为了方便调试Jade会把模板组织成带有形如 <code>__.lineno = 3</code> 的行号的形式。<br>在浏览器里使用的时候，你可以通过传递一个选项 <code>{ compileDebug: false }</code> 来去掉这个。<br>下面的模板</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p Hello <span class="comment">#&#123;name&#125;</span></span><br></pre></td></tr></table></figure>
<p>会被翻译成下面的函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params">locals, attrs, escape, rethrow</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> buf = [];</span><br><span class="line">  <span class="keyword">with</span> (locals || &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">var</span> interp;</span><br><span class="line">    buf.push(<span class="string">'\n&lt;p&gt;Hello '</span> + <span class="built_in">escape</span>((interp = name) == <span class="literal">null</span> ? <span class="string">''</span> : interp) + <span class="string">'\n&lt;/p&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> buf.join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过使用 Jade 的 <code>./runtime.js</code>你可以在浏览器使用这些预编译的模板而不需要使用 Jade, 你只需要使用 <code>runtime.js</code> 里的工具函数, 它们会放在 <code>jade.attrs</code>, <code>jade.escape</code> 这些里。 把选项 <code>{ client: true }</code> 传递给 <code>jade.compile()</code>, Jade 会把这些帮助函数的引用放在<code>jade.attrs</code>, <code>jade.escape</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params">locals, attrs, escape, rethrow</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> attrs = jade.attrs, <span class="built_in">escape</span> = jade.escape, rethrow = jade.rethrow;</span><br><span class="line">  <span class="keyword">var</span> buf = [];</span><br><span class="line">  <span class="keyword">with</span> (locals || &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">var</span> interp;</span><br><span class="line">    buf.push(<span class="string">'\n&lt;p&gt;Hello '</span> + <span class="built_in">escape</span>((interp = name) == <span class="literal">null</span> ? <span class="string">''</span> : interp) + <span class="string">'\n&lt;/p&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> buf.join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="a5"></a></p>
<h2 id="公开-API"><a href="#公开-API" class="headerlink" title="公开 API"></a>公开 API</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jade = <span class="built_in">require</span>(<span class="string">'jade'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compile a function</span></span><br><span class="line"><span class="keyword">var</span> fn = jade.compile(<span class="string">'string of jade'</span>, options);</span><br><span class="line">fn(locals);</span><br></pre></td></tr></table></figure>
<h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><ul>
<li><code>self</code>      使用 <code>self</code> 命名空间来持有本地变量. <em>(默认为 <code>false</code>)</em></li>
<li><code>locals</code>    本地变量对象</li>
<li><code>filename</code>  异常发生时使用，includes 时必需</li>
<li><code>debug</code>     输出 token 和翻译后的函数体</li>
<li><code>compiler</code>  替换掉 jade 默认的编译器</li>
<li><code>compileDebug</code>  <code>false</code>的时候调试的结构不会被输出</li>
<li><code>pretty</code>    为输出加上了漂亮的空格缩进 <em>(默认为 <code>false</code>)</em></li>
</ul>
<p><a name="a6"></a></p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p><a name="a6-1"></a></p>
<h3 id="行结束标志"><a href="#行结束标志" class="headerlink" title="行结束标志"></a>行结束标志</h3><p><strong>CRLF</strong> 和 <strong>CR</strong> 会在编译之前被转换为 <strong>LF</strong> </p>
<p><a name="a6-2"></a></p>
<h3 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h3><p>标签就是一个简单的单词:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html</span><br></pre></td></tr></table></figure>
<p>它会被转换为 <code>&lt;html&gt;&lt;/html&gt;</code></p>
<p>标签也是可以有 id 的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div#container</span><br></pre></td></tr></table></figure>
<p>它会被转换为 <code>&lt;div id=&quot;container&quot;&gt;&lt;/div&gt;</code></p>
<p>怎么加 class 呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div.user-details</span><br></pre></td></tr></table></figure>
<p>转换为 <code>&lt;div class=&quot;user-details&quot;&gt;&lt;/div&gt;</code></p>
<p>多个 class 和 id? 也是可以搞定的:</p>
<pre><code>div#foo.bar.baz
</code></pre><p>转换为 <code>&lt;div id=&quot;foo&quot; class=&quot;bar baz&quot;&gt;&lt;/div&gt;</code></p>
<p>不停的 <code>div div div</code> 很讨厌啊 , 可以这样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#foo</span><br><span class="line">.bar</span><br></pre></td></tr></table></figure>
<p>这个算是我们的语法糖，它已经被很好的支持了，上面的会输出：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"foo"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="a6-3"></a></p>
<h3 id="标签文本"><a href="#标签文本" class="headerlink" title="标签文本"></a>标签文本</h3><p>只需要简单的把内容放在标签之后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p wahoo!</span><br></pre></td></tr></table></figure>
<p>它会被渲染为 <code>&lt;p&gt;wahoo!&lt;/p&gt;</code>.</p>
<p>很帅吧，但是大段的文本怎么办呢：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p</span><br><span class="line">  | foo bar baz</span><br><span class="line">  | rawr rawr</span><br><span class="line">  | super cool</span><br><span class="line">  | go jade go</span><br></pre></td></tr></table></figure>
<p>渲染为 <code>&lt;p&gt;foo bar baz rawr.....&lt;/p&gt;</code></p>
<p>怎么和数据结合起来？ 所有类型的文本展示都可以和数据结合起来，如果我们把 <code>{ name: &#39;tj&#39;, email: &#39;tj@vision-media.ca&#39; }</code> 传给编译函数，下面是模板上的写法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#user #&#123;name&#125; &amp;lt;#&#123;email&#125;&amp;gt;</span><br></pre></td></tr></table></figure>
<p>它会被渲染为 <code>&lt;div id=&quot;user&quot;&gt;tj &amp;lt;tj@vision-media.ca&amp;gt;&lt;/div&gt;</code></p>
<p>当就是要输出 <code>#{}</code> 的时候怎么办? 转义一下!</p>
<pre><code>p \#{something}
</code></pre><p>它会输出 <code>&lt;p&gt;#{something}&lt;/p&gt;</code></p>
<p>同样可以使用非转义的变量 <code>!{html}</code>, 下面的模板将直接输出一个 <code>&lt;script&gt;</code> 标签:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- var html = &quot;&lt;script&gt;&lt;/script&gt;&quot;</span><br><span class="line">| !&#123;html&#125;</span><br></pre></td></tr></table></figure>
<p>内联标签同样可以使用文本块来包含文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">label</span><br><span class="line">  | Username:</span><br><span class="line">  input(name=&apos;user[name]&apos;)</span><br></pre></td></tr></table></figure>
<p>或者直接使用标签文本:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">label Username:</span><br><span class="line">  input(name=&apos;user[name]&apos;)</span><br></pre></td></tr></table></figure>
<p><em>只</em> 包含文本的标签，比如 <code>&lt;script&gt;</code>, <code>&lt;style&gt;</code>, 和 <code>&lt;textarea&gt;</code> 不需要前缀 <code>|</code> 字符, 比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title Example</span><br><span class="line">    script</span><br><span class="line">      if (foo) &#123;</span><br><span class="line">        bar();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        baz();</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>这里还有一种选择，可以使用 <code>.</code> 来开始一段文本块，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p.</span><br><span class="line">  foo asdf</span><br><span class="line">  asdf</span><br><span class="line">   asdfasdfaf</span><br><span class="line">   asdf</span><br><span class="line">  asd.</span><br></pre></td></tr></table></figure>
<p>会被渲染为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;foo asdf</span><br><span class="line">asdf</span><br><span class="line">  asdfasdfaf</span><br><span class="line">  asdf</span><br><span class="line">asd</span><br><span class="line">.</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>这和带一个空格的 <code>.</code> 是不一样的, 带空格的会被 Jade 的解析器忽略，当作一个普通的文字: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p .</span><br></pre></td></tr></table></figure>
<p>渲染为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;.&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>需要注意的是文本块需要两次转义。比如想要输出下面的文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;foo\bar&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p.</span><br><span class="line">  foo\\bar</span><br></pre></td></tr></table></figure>
<p><a name="a6-4"></a></p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>单行注释和 JavaScript 里是一样的，通过 <code>//</code> 来开始，并且必须单独一行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// just some paragraphs</span><br><span class="line">p foo</span><br><span class="line">p bar</span><br></pre></td></tr></table></figure>
<p>渲染为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- just some paragraphs --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>bar<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Jade 同样支持不输出的注释，加一个短横线就行了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//- will not output within markup</span><br><span class="line">p foo</span><br><span class="line">p bar</span><br></pre></td></tr></table></figure>
<p>渲染为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>bar<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="a6-5"></a></p>
<h3 id="块注释"><a href="#块注释" class="headerlink" title="块注释"></a>块注释</h3><p>块注释也是支持的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  //</span><br><span class="line">    #content</span><br><span class="line">      h1 Example</span><br></pre></td></tr></table></figure>
<p>渲染为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span><br><span class="line">  &lt;div id="content"&gt;</span><br><span class="line">    &lt;h1&gt;Example&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Jade 同样很好的支持了条件注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  //if IE</span><br><span class="line">    a(href=&apos;http://www.mozilla.com/en-US/firefox/&apos;) Get Firefox</span><br></pre></td></tr></table></figure>
<p>渲染为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--[if IE]&gt;</span><br><span class="line">    &lt;a href="http://www.mozilla.com/en-US/firefox/"&gt;Get Firefox&lt;/a&gt;</span><br><span class="line">  &lt;![endif]--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="a6-6"></a></p>
<h3 id="内联"><a href="#内联" class="headerlink" title="内联"></a>内联</h3><p>Jade 支持以自然的方式定义标签嵌套:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ul</span><br><span class="line">  li.first</span><br><span class="line">    a(href=&apos;#&apos;) foo</span><br><span class="line">  li</span><br><span class="line">    a(href=&apos;#&apos;) bar</span><br><span class="line">  li.last</span><br><span class="line">    a(href=&apos;#&apos;) baz</span><br></pre></td></tr></table></figure>
<p><a name="a6-7"></a></p>
<h3 id="块展开"><a href="#块展开" class="headerlink" title="块展开"></a>块展开</h3><p>块展开可以帮助你在一行内创建嵌套的标签，下面的例子和上面的是一样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ul</span><br><span class="line">  li.first: a(href=&apos;#&apos;) foo</span><br><span class="line">  li: a(href=&apos;#&apos;) bar</span><br><span class="line">  li.last: a(href=&apos;#&apos;) baz</span><br></pre></td></tr></table></figure>
<p><a name="a6-8"></a></p>
<h3 id="Case"><a href="#Case" class="headerlink" title="Case"></a>Case</h3><p><code>case</code> 表达式按下面这样的形式写:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  body</span><br><span class="line">    friends = 10</span><br><span class="line">    case friends</span><br><span class="line">      when 0</span><br><span class="line">        p you have no friends</span><br><span class="line">      when 1</span><br><span class="line">        p you have a friend</span><br><span class="line">      default</span><br><span class="line">        p you have #&#123;friends&#125; friends</span><br></pre></td></tr></table></figure>
<p>块展开在这里也可以使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">friends = 5</span><br><span class="line"></span><br><span class="line">html</span><br><span class="line">  body</span><br><span class="line">    case friends</span><br><span class="line">      when 0: p you have no friends</span><br><span class="line">      when 1: p you have a friend</span><br><span class="line">      default: p you have #&#123;friends&#125; friends</span><br></pre></td></tr></table></figure>
<p><a name="a6-9"></a></p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>Jade 现在支持使用 <code>(</code> 和 <code>)</code> 作为属性分隔符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a(href=&apos;/login&apos;, title=&apos;View login page&apos;) Login</span><br></pre></td></tr></table></figure>
<p>当一个值是 <code>undefined</code> 或者 <code>null</code> 属性 <em>不</em> 会被加上,<br>所以呢，它不会编译出 ‘something=”null”‘.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div(something=null)</span><br></pre></td></tr></table></figure>
<p>Boolean 属性也是支持的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(type=&quot;checkbox&quot;, checked)</span><br></pre></td></tr></table></figure>
<p>使用代码的 Boolean 属性只有当属性为 <code>true</code> 时才会输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input(type=&quot;checkbox&quot;, checked=someValue)</span><br></pre></td></tr></table></figure>
<p>多行同样也是可用的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input(type=&apos;checkbox&apos;,</span><br><span class="line">  name=&apos;agreement&apos;,</span><br><span class="line">  checked)</span><br></pre></td></tr></table></figure>
<p>多行的时候可以不加逗号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input(type=&apos;checkbox&apos;</span><br><span class="line">  name=&apos;agreement&apos;</span><br><span class="line">  checked)</span><br></pre></td></tr></table></figure>
<p>加点空格，格式好看一点？同样支持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input(</span><br><span class="line">  type=&apos;checkbox&apos;</span><br><span class="line">  name=&apos;agreement&apos;</span><br><span class="line">  checked)</span><br></pre></td></tr></table></figure>
<p>冒号也是支持的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rss(xmlns:atom=&quot;atom&quot;)</span><br></pre></td></tr></table></figure>
<p>假如我有一个 <code>user</code> 对象 <code>{ id: 12, name: &#39;tobi&#39; }</code><br>我们希望创建一个指向 <code>/user/12</code> 的链接 <code>href</code>, 我们可以使用普通的 JavaScript 字符串连接，如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a(href=&apos;/user/&apos; + user.id)= user.name</span><br></pre></td></tr></table></figure>
<p>或者我们使用 Jade 的修改方式, 这个我想很多使用 Ruby 或者 CoffeeScript 的人会看起来像普通的 JS..:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a(href=&apos;/user/#&#123;user.id&#125;&apos;)= user.name</span><br></pre></td></tr></table></figure>
<p><code>class</code> 属性是一个特殊的属性，你可以直接传递一个数组，比如 <code>bodyClasses = [&#39;user&#39;, &#39;authenticated&#39;]</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">body(class=bodyClasses)</span><br></pre></td></tr></table></figure>
<p><a name="a6-10"></a></p>
<h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><p>内联的 HTML 是可以的，我们可以使用管道定义一段文本 :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  body</span><br><span class="line">    | &lt;h1&gt;Title&lt;/h1&gt;</span><br><span class="line">    | &lt;p&gt;foo bar baz&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>或者我们可以使用 <code>.</code> 来告诉 Jade 我们需要一段文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  body.</span><br><span class="line">    &lt;h1&gt;Title&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;foo bar baz&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<p>上面的两个例子都会渲染成相同的结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;&lt;body&gt;&lt;h1&gt;Title&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;foo bar baz&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p> 这条规则适应于在 Jade 里的任何文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  body</span><br><span class="line">    h1 User &lt;em&gt;#&#123;name&#125;&lt;/em&gt;</span><br></pre></td></tr></table></figure>
<p><a name="a6-11"></a></p>
<h3 id="Doctypes"><a href="#Doctypes" class="headerlink" title="Doctypes"></a>Doctypes</h3><p>添加文档类型只需要简单的使用 <code>!!!</code>, 或者 <code>doctype</code> 跟上下面的可选项:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!!!</span><br></pre></td></tr></table></figure>
<p>会渲染出 <em>transitional</em> 文档类型, 或者:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!!! 5</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!!! html</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doctype html</span><br></pre></td></tr></table></figure>
<p>Doctype 是大小写不敏感的, 所以下面两个是一样的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">doctype Basic</span><br><span class="line">doctype basic</span><br></pre></td></tr></table></figure>
<p>当然也是可以直接传递一段文档类型的文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doctype html PUBLIC &quot;-//W3C//DTD XHTML Basic 1.1//EN&quot;</span><br></pre></td></tr></table></figure>
<p>渲染后:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN"&gt;</span></span><br></pre></td></tr></table></figure>
<p>会输出 <em>HTML5</em> 文档类型. 下面的默认的文档类型，可以很简单的扩展：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> doctypes = exports.doctypes = &#123;</span><br><span class="line">  <span class="string">'5'</span>: <span class="string">'&lt;!DOCTYPE html&gt;'</span>,</span><br><span class="line">  <span class="string">'xml'</span>: <span class="string">'&lt;?xml version="1.0" encoding="utf-8" ?&gt;'</span>,</span><br><span class="line">  <span class="string">'default'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'transitional'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'strict'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'frameset'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'1.1'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'basic'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"&gt;'</span>,</span><br><span class="line">  <span class="string">'mobile'</span>: <span class="string">'&lt;!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd"&gt;'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过下面的代码可以很简单的改变默认的文档类型：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jade.doctypes.default = <span class="string">'whatever you want'</span>;</span><br></pre></td></tr></table></figure>
<p><a name="a7"></a></p>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>过滤器前缀 <code>:</code>, 比如 <code>:markdown</code> 会把下面块里的文本交给专门的函数进行处理。查看顶部 <em>特性</em> 里有哪些可用的过滤器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body</span><br><span class="line">  :markdown</span><br><span class="line">    Woah! jade _and_ markdown, very **cool**</span><br><span class="line">    we can even link to [stuff](http://google.com)</span><br></pre></td></tr></table></figure>
<p>渲染为:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>Woah! jade <span class="tag">&lt;<span class="name">em</span>&gt;</span>and<span class="tag">&lt;/<span class="name">em</span>&gt;</span> markdown, very <span class="tag">&lt;<span class="name">strong</span>&gt;</span>cool<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> we can even link to <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://google.com"</span>&gt;</span>stuff<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="a8"></a></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>Jade 目前支持三种类型的可执行代码。第一种是前缀 <code>-</code>， 这是不会被输出的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- var foo = &apos;bar&apos;;</span><br></pre></td></tr></table></figure>
<p>这可以用在条件语句或者循环中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- for (var key in obj)</span><br><span class="line">  p= obj[key]</span><br></pre></td></tr></table></figure>
<p>由于 Jade 的缓存技术，下面的代码也是可以的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- if (foo)</span><br><span class="line">  ul</span><br><span class="line">    li yay</span><br><span class="line">    li foo</span><br><span class="line">    li worked</span><br><span class="line">- else</span><br><span class="line">  p oh no! didnt work</span><br></pre></td></tr></table></figure>
<p>哈哈，甚至是很长的循环也是可以的：</p>
<pre><code>- if (items.length)
  ul
    - items.forEach(function(item){
      li= item
    - })
</code></pre><p>所以你想要的！</p>
<p>下一步我们要 <em>转义</em> 输出的代码，比如我们返回一个值，只要前缀一个 <code>=</code>：   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- var foo = &apos;bar&apos;</span><br><span class="line">= foo</span><br><span class="line">h1= foo</span><br></pre></td></tr></table></figure>
<p>它会渲染为 <code>bar&lt;h1&gt;bar&lt;/h1&gt;</code>. 为了安全起见，使用 <code>=</code> 输出的代码默认是转义的,如果想直接输出不转义的值可以使用 <code>!=</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p!= aVarContainingMoreHTML</span><br></pre></td></tr></table></figure>
<p>Jade 同样是设计师友好的，它可以使 JavaScript 更直接更富表现力。比如下面的赋值语句是相等的，同时表达式还是通常的 JavaScript：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- var foo = &apos;foo &apos; + &apos;bar&apos;</span><br><span class="line">foo = &apos;foo &apos; + &apos;bar&apos;</span><br></pre></td></tr></table></figure>
<p>Jade 会把 <code>if</code>, <code>else if</code>, <code>else</code>, <code>until</code>, <code>while</code>, <code>unless</code> 同别的优先对待, 但是你得记住它们还是普通的 JavaScript：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if foo == &apos;bar&apos;</span><br><span class="line">  ul</span><br><span class="line">    li yay</span><br><span class="line">    li foo</span><br><span class="line">    li worked</span><br><span class="line">else</span><br><span class="line">  p oh no! didnt work</span><br></pre></td></tr></table></figure>
<p><a name="a9"></a></p>
<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>尽管已经支持 JavaScript 原生代码，Jade 还是支持了一些特殊的标签，它们可以让模板更加易于理解，其中之一就是 <code>each</code>, 这种形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">each VAL[, KEY] in OBJ</span><br></pre></td></tr></table></figure>
<p>一个遍历数组的例子 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- var items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span><br><span class="line">each item in items</span><br><span class="line">  li= item</span><br></pre></td></tr></table></figure>
<p>渲染为:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>one<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>two<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>three<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>遍历一个数组同时带上索引：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">items = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span><br><span class="line">each item, i in items</span><br><span class="line">  li #&#123;item&#125;: #&#123;i&#125;</span><br></pre></td></tr></table></figure>
<p>渲染为:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>one: 0<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>two: 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>three: 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>遍历一个数组的键值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">obj = &#123; foo: &apos;bar&apos; &#125;</span><br><span class="line">each val, key in obj</span><br><span class="line">  li #&#123;key&#125;: #&#123;val&#125;</span><br></pre></td></tr></table></figure>
<p>将会渲染为：<code>&lt;li&gt;foo: bar&lt;/li&gt;</code></p>
<p>Jade 在内部会把这些语句转换成原生的 JavaScript 语句，就像使用 <code>users.forEach(function(user){</code>, 词法作用域和嵌套会像在普通的 JavaScript 中一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">each user in users</span><br><span class="line">  each role in user.roles</span><br><span class="line">    li= role</span><br></pre></td></tr></table></figure>
<p>如果你喜欢，也可以使用 <code>for</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for user in users</span><br><span class="line">  for role in user.roles</span><br><span class="line">    li= role</span><br></pre></td></tr></table></figure>
<p><a name="a10"></a></p>
<h2 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h2><p>Jade 条件语句和使用了(<code>-</code>) 前缀的 JavaScript 语句是一致的,然后它允许你不使用圆括号，这样会看上去对设计师更友好一点，<br>同时要在心里记住这个表达式渲染出的是 <em>常规</em> JavaScript：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for user in users</span><br><span class="line">  if user.role == &apos;admin&apos;</span><br><span class="line">    p #&#123;user.name&#125; is an admin</span><br><span class="line">  else</span><br><span class="line">    p= user.name</span><br></pre></td></tr></table></figure>
<p>和下面的使用了常规 JavaScript 的代码是相等的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for user in users</span><br><span class="line">  - if (user.role == &apos;admin&apos;)</span><br><span class="line">    p #&#123;user.name&#125; is an admin</span><br><span class="line">  - else</span><br><span class="line">    p= user.name</span><br></pre></td></tr></table></figure>
<p>Jade 同时支持 <code>unless</code>, 这和 <code>if (!(expr))</code> 是等价的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for user in users</span><br><span class="line">  unless user.isAnonymous</span><br><span class="line">    p</span><br><span class="line">      | Click to view</span><br><span class="line">      a(href=&apos;/users/&apos; + user.id)= user.name</span><br></pre></td></tr></table></figure>
<p><a name="a11"></a></p>
<h2 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h2><p>Jade 支持通过 <code>block</code> 和 <code>extends</code> 关键字来实现模板继承。 一个块就是一个 Jade 的 block ，它将在子模板中实现，同时是支持递归的。</p>
<p>Jade 块如果没有内容，Jade 会添加默认内容，下面的代码默认会输出 <code>block scripts</code>, <code>block content</code>, 和 <code>block foot</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    h1 My Site - #&#123;title&#125;</span><br><span class="line">    block scripts</span><br><span class="line">      script(src=&apos;/jquery.js&apos;)</span><br><span class="line">  body</span><br><span class="line">    block content</span><br><span class="line">    block foot</span><br><span class="line">      #footer</span><br><span class="line">        p some footer content</span><br></pre></td></tr></table></figure>
<p>现在我们来继承这个布局，简单创建一个新文件，像下面那样直接使用 <code>extends</code>，给定路径（可以选择带 <code>.jade</code> 扩展名或者不带）. 你可以定义一个或者更多的块来覆盖父级块内容, 注意到这里的 <code>foot</code> 块 <em>没有</em> 定义，所以它还会输出父级的 “some footer content”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">extends extend-layout</span><br><span class="line"></span><br><span class="line">block scripts</span><br><span class="line">  script(src=&apos;/jquery.js&apos;)</span><br><span class="line">  script(src=&apos;/pets.js&apos;)</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  h1= title</span><br><span class="line">  each pet in pets</span><br><span class="line">    include pet</span><br></pre></td></tr></table></figure>
<p>同样可以在一个子块里添加块，就像下面实现的块 <code>content</code> 里又定义了两个可以被实现的块 <code>sidebar</code> 和 <code>primary</code>，或者子模板直接实现 <code>content</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">extends regular-layout</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  .sidebar</span><br><span class="line">    block sidebar</span><br><span class="line">      p nothing</span><br><span class="line">  .primary</span><br><span class="line">    block primary</span><br><span class="line">      p nothing</span><br></pre></td></tr></table></figure>
<p><a name="a12"></a></p>
<h2 id="前置、追加代码块"><a href="#前置、追加代码块" class="headerlink" title="前置、追加代码块"></a>前置、追加代码块</h2><p>Jade允许你 <em>替换</em> （默认）、 <em>前置</em> 和 <em>追加</em> blocks. 比如，假设你希望在 <em>所有</em> 页面的头部都加上默认的脚本，你可以这么做：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    block head</span><br><span class="line">      script(src=&apos;/vendor/jquery.js&apos;)</span><br><span class="line">      script(src=&apos;/vendor/caustic.js&apos;)</span><br><span class="line">  body</span><br><span class="line">    block content</span><br></pre></td></tr></table></figure>
<p>现在假设你有一个Javascript游戏的页面，你希望在默认的脚本之外添加一些游戏相关的脚本，你可以直接<code>append</code>上代码块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">extends layout</span><br><span class="line"></span><br><span class="line">block append head</span><br><span class="line">  script(src=&apos;/vendor/three.js&apos;)</span><br><span class="line">  script(src=&apos;/game.js&apos;)</span><br></pre></td></tr></table></figure>
<p>使用 <code>block append</code> 或 <code>block prepend</code> 时 <code>block</code> 是可选的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">extends layout</span><br><span class="line"></span><br><span class="line">append head</span><br><span class="line">  script(src=&apos;/vendor/three.js&apos;)</span><br><span class="line">  script(src=&apos;/game.js&apos;)</span><br></pre></td></tr></table></figure>
<p><a name="a13"></a></p>
<h2 id="包含"><a href="#包含" class="headerlink" title="包含"></a>包含</h2><p>Includes 允许你静态包含一段 Jade, 或者别的存放在单个文件中的东西比如 CSS, HTML 非常常见的例子是包含头部和页脚。 假设我们有一个下面目录结构的文件夹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./layout.jade</span><br><span class="line">./includes/</span><br><span class="line">  ./head.jade</span><br><span class="line">  ./tail.jade</span><br></pre></td></tr></table></figure>
<p>下面是 <code>layout.jade</code> 的内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  include includes/head  </span><br><span class="line">  body</span><br><span class="line">    h1 My Site</span><br><span class="line">    p Welcome to my super amazing site.</span><br><span class="line">    include includes/foot</span><br></pre></td></tr></table></figure>
<p>这两个包含 <code>includes/head</code> 和 <code>includes/foot</code> 都会读取相对于给 <code>layout.jade</code> 参数<code>filename</code> 的路径的文件, 这是一个绝对路径，不用担心Express帮你搞定这些了。Include 会解析这些文件，并且插入到已经生成的语法树中，然后渲染为你期待的内容：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My Site<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/javascripts/jquery.js"</span>&gt;</span><span class="undefined"></span><br><span class="line">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/javascripts/app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>My Site<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Welcome to my super lame site.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Copyright&gt;(c) foobar<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>前面已经提到，<code>include</code> 可以包含比如 HTML 或者 CSS 这样的内容。给定一个扩展名后，Jade 不会把这个文件当作一个 Jade 源代码，并且会把它当作一个普通文本包含进来：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    //- css and js have simple filters that wrap them in</span><br><span class="line">        &lt;style&gt; and &lt;script&gt; tags, respectively</span><br><span class="line">    include stylesheet.css</span><br><span class="line">    include script.js</span><br><span class="line">  body</span><br><span class="line">    //- &quot;markdown&quot; files will use the &quot;markdown&quot; filter</span><br><span class="line">        to convert Markdown to HTML</span><br><span class="line">    include introduction.markdown</span><br><span class="line">    //- html files have no filter and are included verbatim</span><br><span class="line">    include content.html</span><br></pre></td></tr></table></figure>
<p>Include 也可以接受块内容，给定的块将会附加到包含文件 <em>最后</em> 的块里。 举个例子，<code>head.jade</code> 包含下面的内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">head</span><br><span class="line">  script(src=&apos;/jquery.js&apos;)</span><br></pre></td></tr></table></figure>
<p>我们可以像下面给<code>include head</code>添加内容, 这里是添加两个脚本.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  include head</span><br><span class="line">    script(src=&apos;/foo.js&apos;)</span><br><span class="line">    script(src=&apos;/bar.js&apos;)</span><br><span class="line">  body</span><br><span class="line">    h1 test</span><br></pre></td></tr></table></figure>
<p>在被包含的模板中，你也可以使用<code>yield</code>语句。<code>yield</code>语句允许你明确地标明<code>include</code>的代码块的放置位置。比如，假设你希望把代码块放在scripts之前，而不是附加在scripts之后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">head</span><br><span class="line">  yield</span><br><span class="line">  script(src=&apos;/jquery.js&apos;)</span><br><span class="line">  script(src=&apos;/jquery.ui.js&apos;)</span><br></pre></td></tr></table></figure>
<p>由于被包含的Jade会按字面解析并合并到AST中，词法范围的变量的效果和直接写在同一个文件中的相同。这就意味着<code>include</code>可以用作partial的替代，例如，假设我们有一个引用了<code>user</code>变量的user.jade`文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h1= user.name</span><br><span class="line">p= user.occupation</span><br></pre></td></tr></table></figure>
<p>接着，当我们迭代users的时候，只需简单地加上<code>include user</code>。因为在循环中<code>user</code>变量已经被定义了，被包含的模板可以访问它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">users = [&#123; name: &apos;Tobi&apos;, occupation: &apos;Ferret&apos; &#125;]</span><br><span class="line"></span><br><span class="line">each user in users</span><br><span class="line">  .user</span><br><span class="line">    include user</span><br></pre></td></tr></table></figure>
<p>以上代码会生成：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Tobi<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Ferret<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>user.jade</code>引用了<code>user</code>变量，如果我们希望使用一个不同的变量<code>user</code>，那么我们可以直接定义一个新变量<code>user = person</code>，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">each person in users</span><br><span class="line">  .user</span><br><span class="line">    user = person</span><br><span class="line">    include user</span><br></pre></td></tr></table></figure>
<p><a name="a14"></a></p>
<h2 id="Mixins"><a href="#Mixins" class="headerlink" title="Mixins"></a>Mixins</h2><p>Mixins 在编译的模板里会被 Jade 转换为普通的 JavaScript 函数。 Mixins 可以还参数，但不是必需的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mixin list</span><br><span class="line">  ul</span><br><span class="line">    li foo</span><br><span class="line">    li bar</span><br><span class="line">    li baz</span><br></pre></td></tr></table></figure>
<p>使用不带参数的 mixin 看上去非常简单，在一个块外：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h2 Groceries</span><br><span class="line">mixin list</span><br></pre></td></tr></table></figure>
<p>Mixins 也可以带一个或者多个参数，参数就是普通的 JavaScript 表达式，比如下面的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mixin pets(pets)</span><br><span class="line">  ul.pets</span><br><span class="line">    - each pet in pets</span><br><span class="line">      li= pet</span><br><span class="line"></span><br><span class="line">mixin profile(user)</span><br><span class="line">  .user</span><br><span class="line">    h2= user.name</span><br><span class="line">    mixin pets(user.pets)</span><br></pre></td></tr></table></figure>
<p>会输出像下面的 HTML:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>tj<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"pets"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>tobi<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>loki<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>jane<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>manny<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="a15"></a></p>
<h2 id="产生输出"><a href="#产生输出" class="headerlink" title="产生输出"></a>产生输出</h2><p>假设我们有下面的 Jade 源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- var title = &apos;yay&apos;</span><br><span class="line">h1.title #&#123;title&#125;</span><br><span class="line">p Just an example</span><br></pre></td></tr></table></figure>
<p>当 <code>compileDebug</code> 选项不是 <code>false</code>, Jade 会编译时会把函数里加上 <code>__.lineno = n;</code>, 这个参数会在编译出错时传递给 <code>rethrow()</code>, 而这个函数会在 Jade 初始输出时给出一个有用的错误信息。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params">locals</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> __ = &#123; lineno: <span class="number">1</span>, input: <span class="string">"- var title = 'yay'\nh1.title #&#123;title&#125;\np Just an example"</span>, filename: <span class="string">"testing/test.js"</span> &#125;;</span><br><span class="line">  <span class="keyword">var</span> rethrow = jade.rethrow;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> attrs = jade.attrs, <span class="built_in">escape</span> = jade.escape;</span><br><span class="line">    <span class="keyword">var</span> buf = [];</span><br><span class="line">    <span class="keyword">with</span> (locals || &#123;&#125;) &#123;</span><br><span class="line">      <span class="keyword">var</span> interp;</span><br><span class="line">      __.lineno = <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">var</span> title = <span class="string">'yay'</span></span><br><span class="line">      __.lineno = <span class="number">2</span>;</span><br><span class="line">      buf.push(<span class="string">'&lt;h1'</span>);</span><br><span class="line">      buf.push(attrs(&#123; <span class="string">"class"</span>: (<span class="string">'title'</span>) &#125;));</span><br><span class="line">      buf.push(<span class="string">'&gt;'</span>);</span><br><span class="line">      buf.push(<span class="string">''</span> + <span class="built_in">escape</span>((interp = title) == <span class="literal">null</span> ? <span class="string">''</span> : interp) + <span class="string">''</span>);</span><br><span class="line">      buf.push(<span class="string">'&lt;/h1&gt;'</span>);</span><br><span class="line">      __.lineno = <span class="number">3</span>;</span><br><span class="line">      buf.push(<span class="string">'&lt;p&gt;'</span>);</span><br><span class="line">      buf.push(<span class="string">'Just an example'</span>);</span><br><span class="line">      buf.push(<span class="string">'&lt;/p&gt;'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> buf.join(<span class="string">""</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    rethrow(err, __.input, __.filename, __.lineno);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当 <code>compileDebug</code> 参数是 <code>false</code>, 这个参数会被去掉，这样对于轻量级的浏览器端模板是非常有用的。结合 Jade 的参数和当前源码库里的 <code>./runtime.js</code> 文件，你可以通过 <code>toString()</code> 来编译模板而不需要在浏览器端运行整个 Jade 库，这样可以提高性能，也可以减少载入的 JavaScript 数量。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params">locals</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> attrs = jade.attrs, <span class="built_in">escape</span> = jade.escape;</span><br><span class="line">  <span class="keyword">var</span> buf = [];</span><br><span class="line">  <span class="keyword">with</span> (locals || &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">var</span> interp;</span><br><span class="line">    <span class="keyword">var</span> title = <span class="string">'yay'</span></span><br><span class="line">    buf.push(<span class="string">'&lt;h1'</span>);</span><br><span class="line">    buf.push(attrs(&#123; <span class="string">"class"</span>: (<span class="string">'title'</span>) &#125;));</span><br><span class="line">    buf.push(<span class="string">'&gt;'</span>);</span><br><span class="line">    buf.push(<span class="string">''</span> + <span class="built_in">escape</span>((interp = title) == <span class="literal">null</span> ? <span class="string">''</span> : interp) + <span class="string">''</span>);</span><br><span class="line">    buf.push(<span class="string">'&lt;/h1&gt;'</span>);</span><br><span class="line">    buf.push(<span class="string">'&lt;p&gt;'</span>);</span><br><span class="line">    buf.push(<span class="string">'Just an example'</span>);</span><br><span class="line">    buf.push(<span class="string">'&lt;/p&gt;'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> buf.join(<span class="string">""</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="a16"></a></p>
<h2 id="Makefile-的一个例子"><a href="#Makefile-的一个例子" class="headerlink" title="Makefile 的一个例子"></a>Makefile 的一个例子</h2><p>通过执行 <code>make</code>， 下面的 Makefile 例子可以把 <code>pages/*.jade</code> 编译为 <code>pages/*.html</code> 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">JADE = $(shell find pages/*.jade)</span><br><span class="line">HTML = $(JADE:.jade=.html)</span><br><span class="line"></span><br><span class="line">all: $(HTML)</span><br><span class="line">	</span><br><span class="line">%.html: %.jade</span><br><span class="line">	jade &lt; $&lt; --path $&lt; &gt; $@</span><br><span class="line"></span><br><span class="line">clean:</span><br><span class="line">	rm -f $(HTML)</span><br><span class="line"></span><br><span class="line">.PHONY: clean</span><br></pre></td></tr></table></figure>
<p>这个可以和 <code>watch(1)</code> 命令起来产生像下面的行为： </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ watch make</span><br></pre></td></tr></table></figure>
<p><a name="a17"></a></p>
<h2 id="命令行的-Jade"><a href="#命令行的-Jade" class="headerlink" title="命令行的 Jade"></a>命令行的 Jade</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">使用: jade [options] [dir|file ...]</span><br><span class="line"></span><br><span class="line">选项:</span><br><span class="line"></span><br><span class="line">  -h, --help         输出帮助信息</span><br><span class="line">  -v, --version      输出版本号</span><br><span class="line">  -o, --out &lt;dir&gt;    输出编译后的 HTML 到 &lt;dir&gt;</span><br><span class="line">  -O, --obj &lt;str&gt;    JavaScript 选项</span><br><span class="line">  -p, --path &lt;path&gt;  在处理 stdio 时，查找包含文件时的查找路径</span><br><span class="line">  -P, --pretty       格式化 HTML 输出</span><br><span class="line">  -c, --client       编译浏览器端可用的 runtime.js</span><br><span class="line">  -D, --no-debug     关闭编译的调试选项(函数会更小)</span><br><span class="line">  -w, --watch        监视文件改变自动刷新编译结果</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line"></span><br><span class="line">  # 编译整个目录</span><br><span class="line">  $ jade templates</span><br><span class="line"></span><br><span class="line">  # 生成 &#123;foo,bar&#125;.html</span><br><span class="line">  $ jade &#123;foo,bar&#125;.jade</span><br><span class="line"></span><br><span class="line">  # 在标准IO下使用jade </span><br><span class="line">  $ jade &lt; my.jade &gt; my.html</span><br><span class="line"></span><br><span class="line">  # 在标准IO下使用jade, 同时指定用于查找包含的文件</span><br><span class="line">  $ jade &lt; my.jade -p my.jade &gt; my.html</span><br><span class="line"></span><br><span class="line">  # 在标准IO下使用jade </span><br><span class="line">  $ echo &quot;h1 Jade!&quot; | jade</span><br><span class="line"></span><br><span class="line">  # foo, bar 目录渲染到 /tmp</span><br><span class="line">  $ jade foo bar --out /tmp</span><br></pre></td></tr></table></figure>
<p><em>注意: 从 <code>v0.31.0</code> 的 <code>-o</code> 选项已经指向 <code>--out</code>, <code>-O</code> 相应做了交换</em></p>
<p><a name="a18"></a></p>
<h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><ul>
<li>cssdeck interactive <a href="http://cssdeck.com/labs/learning-the-jade-templating-engine-syntax" target="_blank" rel="external">Jade syntax tutorial</a></li>
<li>cssdeck interactive <a href="http://cssdeck.com/labs/jade-templating-tutorial-codecast-part-2" target="_blank" rel="external">Jade logic tutorial</a></li>
<li>in <a href="http://blog.craftgear.net/4f501e97c1347ec934000001/title/10%E5%88%86%E3%81%A7%E3%82%8F%E3%81%8B%E3%82%8Bjade%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3" target="_blank" rel="external">Japanese</a></li>
</ul>
<p><a name="a19"></a></p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>(The MIT License)</p>
<p>Copyright (c) 2009-2010 TJ Holowaychuk &lt;tj@vision-media.ca&gt;</p>
<p>Permission is hereby granted, free of charge, to any person obtaining<br>a copy of this software and associated documentation files (the<br>‘Software’), to deal in the Software without restriction, including<br>without limitation the rights to use, copy, modify, merge, publish,<br>distribute, sublicense, and/or sell copies of the Software, and to<br>permit persons to whom the Software is furnished to do so, subject to<br>the following conditions:</p>
<p>The above copyright notice and this permission notice shall be<br>included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED ‘AS IS’, WITHOUT WARRANTY OF ANY KIND,<br>EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF<br>MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.<br>IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY<br>CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,<br>TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE<br>SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/28/Jade教程/" data-id="cimf02ydk000alvz310utm4t0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Jade/">Jade</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/28/hello-world/" class="article-date">
  <time datetime="2016-03-28T04:12:09.000Z" itemprop="datePublished">2016-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/28/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/28/hello-world/" data-id="cimf02ydi0008lvz33q4d1rgk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-MDN-CSS入门教程学习笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/27/MDN-CSS入门教程学习笔记/" class="article-date">
  <time datetime="2016-03-26T16:00:00.000Z" itemprop="datePublished">2016-03-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CSS/">CSS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/27/MDN-CSS入门教程学习笔记/">MDN-CSS入门教程学习笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>摘自MDN- <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started" target="_blank" rel="external">CSS入门教程</a></p>
</blockquote>
<h1 id="选择器-Selectors"><a href="#选择器-Selectors" class="headerlink" title="选择器(Selectors)"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started/Selectors" target="_blank" rel="external">选择器(Selectors)</a></h1><h3 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h3><h3 id="ID选择器"><a href="#ID选择器" class="headerlink" title="ID选择器"></a>ID选择器</h3><h3 id="伪类选择器（Pseudo-classes-selectors）"><a href="#伪类选择器（Pseudo-classes-selectors）" class="headerlink" title="伪类选择器（Pseudo-classes selectors）"></a>伪类选择器（Pseudo-classes selectors）</h3><p>CSS伪类（pseudo-class）是加在选择器后面的用来指定元素状态的关键字。比如，:hover会在鼠标悬停在选中元素上时应用相应的样式。</p>
<p>伪类和伪元素（Pseudo-elements）不仅可以让你为符合某种文档树结构的元素指定样式，还可以为某些外部条件的元素指定样式：浏览历史（比如是否访问过（:visited），内容状态（如:checked），鼠标位置(如:hover)）.</p>
<p>伪类列表</p>
<ul>
<li>:link</li>
<li>:visited</li>
<li>:active</li>
<li>:hover</li>
<li>:focus</li>
<li>:first-child</li>
<li>:nth-child</li>
<li>:nth-last-child</li>
<li>:nth-of-type</li>
<li>:first-of-type</li>
<li>:last-of-type</li>
<li>:empty</li>
<li>:target</li>
<li>:checked</li>
<li>:enabled</li>
<li>:disabled</li>
</ul>
<h2 id="基于关系的选择器"><a href="#基于关系的选择器" class="headerlink" title="基于关系的选择器"></a>基于关系的选择器</h2><table>
<thead>
<tr>
<th>选择器</th>
<th>选择的元素</th>
</tr>
</thead>
<tbody>
<tr>
<td>A E</td>
<td>任何是元素A的后代元素E（后代节点指A的子节点，子节点的子节点，以此类推）</td>
</tr>
<tr>
<td>A &gt; E</td>
<td>任何元素A的子元素</td>
</tr>
<tr>
<td>E:first-child</td>
<td>任何元素的第一个子元素E</td>
</tr>
<tr>
<td>B+E</td>
<td>任何元素B的下一个兄弟元素E</td>
</tr>
<tr>
<td>B~E</td>
<td>B元素后面的拥有共同父元素的兄弟元素E</td>
</tr>
</tbody>
</table>
<h2 id="实例：使用基于关系的选择器和伪类选择器"><a href="#实例：使用基于关系的选择器和伪类选择器" class="headerlink" title="实例：使用基于关系的选择器和伪类选择器"></a>实例：使用基于关系的选择器和伪类选择器</h2><p>通过使用基于关系的选择器和伪类选择器，你可以构造出复杂的叠加算法。这是一个常用的技巧，比如可以用来创建纯CSS无JavaScript的下拉菜单（pure-CSS dropdown menus）。关键点就是创建下面这类规则：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.menu-bar</span> <span class="selector-tag">ul</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.menu-bar</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &gt; <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后将这些规则应用到下面的HTML结构中：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"menu-bar"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"menu-nav"</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Submenu<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"menu-nav"</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Submenu<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"example.html"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="http://tanhanjay.github.io/src/纯CSS无JavaScript的下拉菜单.html" target="_blank" rel="external">演示</a></p>
<h1 id="Content-内容"><a href="#Content-内容" class="headerlink" title="Content(内容)"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started/Content" target="_blank" rel="external">Content(内容)</a></h1><p>在样式中可以定义文本内容和图片内容。当内容与文档结构紧密相关的时候，你可以在样式表中指定内容。</p>
<h4 id="更多细节"><a href="#更多细节" class="headerlink" title="更多细节"></a>更多细节</h4><ul>
<li>在样式表中指定内容会使事情变得复杂：你可能有多个语言版本的文档共享同一个样式表。如果样式表的一部分需要翻译，这就意味着你需要将这部分单独保存在多个样式表中，并在不同语言的文档中引用。</li>
</ul>
<ul>
<li>如果你指定的内容由通用符号和图片组成的话，就不存在这个问题。</li>
</ul>
<ul>
<li>样式表中指定的内容不会成为DOM的一部分。</li>
</ul>
<h3 id="文本内容"><a href="#文本内容" class="headerlink" title="文本内容"></a>文本内容</h3><p>CSS只可以在元素的前后插入文本：在选择器的后面加上`    :before 或者 · :after。在声明中，指定content属性，并设置文本内容。</p>
<h4 id="更多细节-1"><a href="#更多细节-1" class="headerlink" title="更多细节"></a>更多细节</h4><ul>
<li>样式表默认使用UTF-8字符集。也可以通过link属性或样式表以及其他方式指定。 参见 CSS规范中<a href="http://www.w3.org/TR/CSS21/syndata.html#q23" target="_blank" rel="external">4.4 CSS style sheet representation</a></li>
</ul>
<ul>
<li>还可以通过转义机制（通过反斜杠转义）指定单个字符。比如， \265B 是国际象棋黑皇后的符号 ♛。更多参见 <a href="http://www.w3.org/TR/CSS21/syndata.html#q24" target="_blank" rel="external">Referring to characters not represented in a character encoding </a>和CSS规范中的<a href="http://www.w3.org/TR/CSS21/syndata.html#q6" target="_blank" rel="external"> Characters and case。</a></li>
</ul>
<h1 id="List中的counter-计数器"><a href="#List中的counter-计数器" class="headerlink" title="List中的counter(计数器)"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Getting_started/Lists#计数器" target="_blank" rel="external">List中的counter</a>(计数器)</h1><p><strong>注意:  一些浏览器不支持计数器。Quirks Mode site 的CSS contents and browser compatibility 页有更多这方面的兼容表格可以参考。 CSS Reference 也有浏览器兼容性表格。</strong></p>
<p>你可以用计数器来计数任何元素，不仅是列表元素。比如，在某些文档中你可能想计数标题和段落。</p>
<p>要想计数，你必须定义一个计数器。</p>
<p>在计数开始前的某个元素上，设置 counter-reset属性以重置计数器。被计数元素的父节点是一个不错的选择。当然，任何出现在被计数元素前面的元素都可以。</p>
<p>设置每个需要计数的元素的counter-increment 属性为你的计数器名。</p>
<p>通过为选择器增加 :before 或 :after 并设置 content 属性来显示计数器。 (如上一节所示, 内容).</p>
<p>在content属性的值中设置 counter()，在括号内填上计数器的名字。可选的是设置计数器类型。其类型和前面一节 有序列表 中相同。</p>
<p>正常情况下，显示计数器的元素也会递增计数器。</p>
<p>例<br>这条规则会为每个类名中包含numbered的</p><h3> 元素初始化计数器 mynum：<p></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h3</span><span class="selector-class">.numbered</span> &#123;<span class="attribute">counter-reset</span>: mynum;&#125;</span><br></pre></td></tr></table></figure>
<p>这条规则为每个类名包含numbered的</p><p>元素显示并递增计数器：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-class">.numbered</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">counter</span>(mynum) <span class="string">": "</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">counter-increment</span>: mynum;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">font-weight</span>: bold;&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p>Heading<br>1: Lorem ipsum</p>
<p>2: Dolor sit</p>
<p>3: Amet consectetuer</p>
<p>4: Magna aliquam</p>
<p>5: Autem veleum</p>
<h4 id="更多细节-2"><a href="#更多细节-2" class="headerlink" title="更多细节"></a>更多细节</h4><ul>
<li>除非所有看你文档的人的浏览器都支持计数器，否则你不能使用计数器。</li>
</ul>
<ul>
<li>如果你可以使用计数器，那么你可以单独设置计数器的样式。如上面例子所示：计数器是粗体，但列表不是。</li>
</ul>
<ul>
<li>你还可以用更复杂的方式使用计数器。比如，计数章节, 标题, 子标题以及段落。详见CSS规范中的 <a href="http://www.w3.org/TR/CSS21/generate.html#counters" target="_blank" rel="external">Automatic counters and numbering </a>。</li>
</ul>
</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/27/MDN-CSS入门教程学习笔记/" data-id="cimf02yde0005lvz3kjge7s3n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-常用的终端(Terminal)命令" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/26/常用的终端(Terminal)命令/" class="article-date">
  <time datetime="2016-03-25T16:00:00.000Z" itemprop="datePublished">2016-03-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/unix-linux/">unix/linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/26/常用的终端(Terminal)命令/">常用的终端（Terminal）命令（适用于Mac OSX）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Mac查看端口占用情况"><a href="#Mac查看端口占用情况" class="headerlink" title="Mac查看端口占用情况"></a>Mac查看端口占用情况</h3><p>命令 lsof -i tcp:port  （port替换成端口号，比如6379）可以查看该端口被什么程序占用，并显示PID，方便KILL</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/26/常用的终端(Terminal)命令/" data-id="cimf02yd60001lvz3900s1pmh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript Bad Parts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/25/JavaScript Bad Parts/" class="article-date">
  <time datetime="2016-03-24T16:00:00.000Z" itemprop="datePublished">2016-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/25/JavaScript Bad Parts/">JavaScript Bad Parts</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>本文摘自《JavaScript The Good Parts》中文版</p>
</blockquote>
<h3 id=""><a href="#" class="headerlink" title="=="></a>==</h3><p>JavaScript有两组相等运算符：===和！==，以及它们邪恶的孪生兄弟==和！=。===和！==这一组运算符会按照你期望的方式工作。如果两个运算数类型一致且拥有相同的值，那么===返回true，!==会返回false。而它们邪恶的孪生兄弟只有在两个运算数类型一致时才会做出正确的判断，如果两个运算数是不同的类型，它们试图去强制转换值得类型。转换的规则复杂且难以记忆。这里有一些有趣的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span> == <span class="string">'0'</span>  			<span class="comment">//false</span></span><br><span class="line"><span class="number">0</span> == <span class="string">''</span> 			<span class="comment">//true</span></span><br><span class="line"><span class="number">0</span> == <span class="string">'0'</span>			<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="string">'false'</span>	<span class="comment">//false</span></span><br><span class="line"><span class="literal">false</span> == <span class="string">'0'</span>		<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="literal">false</span> == <span class="literal">undefined</span> 	<span class="comment">//false</span></span><br><span class="line"><span class="literal">false</span> == <span class="literal">null</span>		<span class="comment">//false</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span> 	<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="string">' \t\r\n '</span> == <span class="number">0</span>		<span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>==运算符对传递性的缺乏值得我们警惕。我的建议是永远不要使用那对邪恶的孪生兄弟。相反，请始终使用===和!==。如果以上所有的比较使用 === 运算符，结果都是false。</p>
<h3 id="with语句"><a href="#with语句" class="headerlink" title="with语句"></a>with语句</h3><p>JavaScript提供了一个with语句，本意是想用它来快捷地访问对象的属性。不幸的是，它的结果可能有时不可预料，所以应该避免使用它。</p>
<p>下面的语句：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span>(obj)&#123;</span><br><span class="line">  a = b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和下面的代码做的是同样的事情：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(obj.a === <span class="literal">undefined</span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/25/JavaScript Bad Parts/" data-id="cimf02ydb0003lvz369kc375z" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript的毒瘤" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/20/JavaScript的毒瘤/" class="article-date">
  <time datetime="2016-03-19T16:00:00.000Z" itemprop="datePublished">2016-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/20/JavaScript的毒瘤/">JavaScript语言的毒瘤</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JavaScript语言的毒瘤"><a href="#JavaScript语言的毒瘤" class="headerlink" title="JavaScript语言的毒瘤"></a>JavaScript语言的毒瘤</h1><h3 id="自动插入分号"><a href="#自动插入分号" class="headerlink" title="自动插入分号"></a>自动插入分号</h3><p>JavaScript有一个自动修复机制，它试图通过自动插入分号来修正有缺损的程序。但是，千万不要指望它，它可能会掩盖更为严重的错误。<br>有时它会不合时宜地插入分号。请考虑在return语句中自动插入分号导致的后果。如果一个return语句返回一个值，这个值表达式的开始部分必须和return位于同一行：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span></span><br><span class="line">    &#123;</span><br><span class="line">      status:<span class="literal">true</span></span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
<p>这看起来是要返回一个包含status成员元素的对象。遗憾的是，自动插入分号让它变成了返回undefined。自动插入分号导致程序被误解，却没有任何警告提醒。如果把{放在上一行的尾部而不是下一行的头部就可以避免该问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  status: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="保留字"><a href="#保留字" class="headerlink" title="保留字"></a>保留字</h3><p>下面的单词在JavaScript里被保留：<br>abstract boolean break byte case catch char class const continue debugger default delete do double else enum export extends false final finally float for function goto if implements import in instanceof int interface long native new null package private protected public return short static super switch synchronized this throw throws transient true try typeof var volatile void while with</p>
<p>这些单词中的大多数并没有在语言中使用。<br>它们不能被用来命名变量或参数。当保留字被用作对象字面量的键值时，它们必须被引号括起来。它们不能被用在点表示法中，所以有时必须使用括号表示法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> method;                   <span class="comment">//ok</span></span><br><span class="line"><span class="keyword">var</span> <span class="class"><span class="keyword">class</span></span>;                    <span class="comment">//非法</span></span><br><span class="line">object = &#123;box: value&#125;;        <span class="comment">//ok</span></span><br><span class="line">object = &#123;<span class="keyword">case</span>: value&#125;;       <span class="comment">//非法</span></span><br><span class="line">object = &#123;<span class="string">'case'</span>: value&#125;;     <span class="comment">//ok</span></span><br><span class="line">object.box = value;           <span class="comment">//ok</span></span><br><span class="line">object.case = value;          <span class="comment">//非法</span></span><br><span class="line">object[<span class="string">'case'</span>] = value;       <span class="comment">//ok</span></span><br></pre></td></tr></table></figure>
<h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><p>typeof 运算符返回一个用于识别其运算数类型的字符串。所以：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeof 98.6</span><br></pre></td></tr></table></figure>
<p>返回‘number’。遗憾的是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeof null</span><br></pre></td></tr></table></figure>
<p>返回’object’而不是’null’。这简直太糟糕了。其实，有更简单也更好的检测null的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_value === null</span><br></pre></td></tr></table></figure>
<p>一个更大的问题是检测对象的值。typeof不能辨识出null于对象，但你可以下面这样做，因为null值为假，而所有对象值为真：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (my_value &amp;&amp; <span class="keyword">typeof</span> === <span class="string">'object'</span>) &#123;</span><br><span class="line">  <span class="comment">// my_value 是一个对象或数组！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相关的内容，请参阅后面的小节”NaN”和“伪数组”。</p>
<p>在对正则表达式的类型识别上，各种JavaScript的实现不太一致。对于下面的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> /a/</span><br></pre></td></tr></table></figure>
<p>一些实现会返回’object’,而其他的返回’function’。如果返回’regexp’可能会更有用些，但标准不允许这么做。</p>
<h3 id="NaN"><a href="#NaN" class="headerlink" title="NaN"></a>NaN</h3><p>NaN 是IEEE754中定义的一个特殊的数量值。它表示的不是一个数字，尽管下面的表达式返回的是true:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">NaN</span> === <span class="string">'number'</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>该值可能会在试图把非数字形式的字符串转换为数字时产生。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="string">'0'</span> <span class="comment">//0</span></span><br><span class="line">+ <span class="string">'oops'</span> <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>
<p>如果NaN是数学运算中的一个运算数，那么结果就是NaN。所以，如果你有一个公式链产生出NaN的结果，那肯定要么其中一个输入项是NaN，要么在某个地方产生了NaN。</p>
<p>你可以对NaN进行检测。正如我们之前所见，typeof不能辨别数字和NaN，而且NaN也不等同于它自己。所以，下面的代码结果令人惊讶：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span> <span class="comment">//false</span></span><br><span class="line"><span class="literal">NaN</span> !== <span class="literal">NaN</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>JavaScript 提供了一个isNaN函数，可以辨别数字与NaN:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>)		<span class="comment">//true</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="number">0</span>)		<span class="comment">//false</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">'oops'</span>)	<span class="comment">//true</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">'0'</span>)		<span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<p>判断一个值是否可用做数字的最佳方法是使用isFinite函数，因为它会筛除掉NaN和Infinity。遗憾的是isFinite会试图把它的运算数转换成一个数字，所以，如果值事实上不是一个数字，它就不是一个好的测试。你可以这样定义自己的isNumber函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isNumber = <span class="function"><span class="keyword">function</span> <span class="title">isNumber</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; <span class="built_in">isFinite</span>(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="伪数组"><a href="#伪数组" class="headerlink" title="伪数组"></a>伪数组</h3><p>JavaScript没有真正的数组。这也不全是坏事。JavaScript的数组确实非常容易使用。你不必给它们设置维度，而且它们永远不会产生越界（out-of-bounds）错误。但它们的性能相比真正的数组可能相当糟糕。</p>
<p>typeof运算符不能辨别数组和对象。要辨别一个值是否为数组，你还需要检查它的constructor属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(my_value &amp;&amp; <span class="keyword">typeof</span> my_value === <span class="string">'object'</span> &amp;&amp; my_value.constructor === <span class="built_in">Array</span>) &#123;</span><br><span class="line">  	<span class="comment">//my_value是一个数组。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的检测对于在不同帧或窗口创建的数组将会给出false。当数组有可能在其他的帧中被创建时，下面的检测更为可靠：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.toString.apply(my_value) === <span class="string">'[object Array]'</span>)&#123;</span><br><span class="line">  <span class="comment">//my_value 确实是一个数组！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>arguments数组不是一个数组，它只是一个有着length成员属性的对象。上面的检测会分辨出arguments并不是一个数组。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="tanhanjay.top/2016/03/20/JavaScript的毒瘤/" data-id="cimf02yd20000lvz36fgdzndj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/unix-linux/">unix/linux</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jade/">Jade</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Jade/" style="font-size: 10px;">Jade</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/30/LearnCode笔记-ES6新特性/">LearnCode笔记--ES6新特性</a>
          </li>
        
          <li>
            <a href="/2016/03/28/Jade教程/">Jade教程</a>
          </li>
        
          <li>
            <a href="/2016/03/28/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2016/03/27/MDN-CSS入门教程学习笔记/">MDN-CSS入门教程学习笔记</a>
          </li>
        
          <li>
            <a href="/2016/03/26/常用的终端(Terminal)命令/">常用的终端（Terminal）命令（适用于Mac OSX）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
   
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Teng Haojun<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>